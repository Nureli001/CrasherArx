<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crasher Online Sınaq Sistemi</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; padding: 20px; line-height: 1.6; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; }
        #timer { position: sticky; top: 10px; background: #e74c3c; color: white; padding: 10px; border-radius: 5px; text-align: center; font-weight: bold; z-index: 100; }
        .question-block { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; transition: 0.3s; }
        .option { display: block; margin: 8px 0; cursor: pointer; padding: 5px; border-radius: 4px; }
        .option:hover { background: #f0f0f0; }
        button { display: block; width: 100%; padding: 15px; font-size: 18px; background: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
        button:hover { background: #27ae60; }
        #result { margin-top: 20px; }
        .correct-ans { background-color: #d4edda !important; border-color: #c3e6cb; }
        .wrong-ans { background-color: #f8d7da !important; border-color: #f5c6cb; }
        .skipped-ans { background-color: #fff3cd !important; border-color: #ffeeba; }
    </style>
</head>
<body>

<div class="container">
    <h2>Online Sınaq İmtahanı</h2>
    <div id="timer">Yüklənir...</div>
    <div id="quiz">Suallar hazırlanır, xahiş edirik gözləyin...</div>
    <button id="finishBtn" onclick="finish()">İmtahanı Bitir</button>
    <div id="result"></div>
</div>

<script>
let TIME = 30 * 60;
let interval;
let startScore = 0;
let currentQuestions = [];
const QUESTIONS_URL = "questions.json";

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

async function start() {
    const val = prompt("İmtahana giriş balın neçədir? (0–50)");
    startScore = parseInt(val);
    if (isNaN(startScore) || startScore < 0 || startScore > 50) {
        alert("Zəhmət olmasa 0 və 50 arası düzgün rəqəm daxil edin.");
        return start();
    }

    try {
        const res = await fetch(QUESTIONS_URL);
        let allQuestions = await res.json();
        allQuestions = allQuestions.filter(q => q.correct && q.correct !== "");
        currentQuestions = shuffle(allQuestions).slice(0, 25);
        
        const quizDiv = document.getElementById("quiz");
        quizDiv.innerHTML = "";

        currentQuestions.forEach((q, i) => {
            let optionsHtml = "";
            let keys = Object.keys(q.options); 
            
            keys.forEach(key => {
                optionsHtml += `
                    <label class="option">
                        <input type="radio" name="q${i}" value="${key}"> ${key}) ${q.options[key]}
                    </label>`;
            });

            // "Boşluq" variantının əlavə edilməsi (Həmişə axırda)
            optionsHtml += `
                <label class="option" style="color: #7f8c8d; border-top: 1px dashed #ccc; margin-top: 10px;">
                    <input type="radio" name="q${i}" value="BOS"> <i>Boşluq (Bal silinmir)</i>
                </label>`;

            quizDiv.innerHTML += `
                <div id="block${i}" class="question-block">
                    <p><b>${i + 1}. ${q.q}</b></p>
                    ${optionsHtml}
                    <div id="feedback${i}" style="margin-top:10px;"></div>
                </div>`;
        });

        interval = setInterval(updateTimer, 1000);
    } catch (err) {
        document.getElementById("quiz").innerHTML = "Xəta: Suallar yüklənmədi.";
    }
}

function updateTimer() {
    if (TIME <= 0) { finish(); return; }
    TIME--;
    let m = Math.floor(TIME / 60);
    let s = TIME % 60;
    document.getElementById("timer").innerText = `Qalan vaxt: ${m}:${s < 10 ? '0'+s : s}`;
}

function finish() {
    clearInterval(interval);
    window.scrollTo(0, 0);
    document.getElementById("finishBtn").style.display = "none";

    let correctCount = 0;
    let wrongCount = 0;
    let skippedCount = 0;
    
    currentQuestions.forEach((q, i) => {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        const block = document.getElementById(`block${i}`);
        const feedback = document.getElementById(`feedback${i}`);

        if (selected) {
            if (selected.value === q.correct) {
                correctCount++;
                block.classList.add("correct-ans");
                feedback.innerHTML = "<b>✅ Doğru (+2 bal)</b>";
            } else if (selected.value === "BOS") {
                skippedCount++;
                block.classList.add("skipped-ans");
                feedback.innerHTML = `<b>⚪ Boş buraxıldı (0 bal).</b> Düzgün: <b style="color:green">${q.correct}</b>`;
            } else {
                wrongCount++;
                block.classList.add("wrong-ans");
                feedback.innerHTML = `<b>❌ Səhv! (-1 bal).</b> Düzgün: <b style="color:green">${q.correct}</b>`;
            }
        } else {
            skippedCount++;
            block.classList.add("skipped-ans");
            feedback.innerHTML = `<b>⚪ Cavablandırılmadı (0 bal).</b> Düzgün: <b style="color:green">${q.correct}</b>`;
        }
    });

    // Riyazi hesablama: Düzgünlər * 2, Səhvlər * (-1)
    let examScore = (correctCount * 2) - (wrongCount * 1);
    let total = startScore + examScore;
    
    document.getElementById("result").innerHTML = `
        <div style="background:#2c3e50; color:white; padding:20px; border-radius:10px; text-align:center;">
            <h2>İmtahan Nəticəsi</h2>
            <p>Doğru cavab: ${correctCount} x 2 = +${correctCount * 2}</p>
            <p>Səhv cavab: ${wrongCount} x 1 = -${wrongCount}</p>
            <p>Boş buraxılan: ${skippedCount}</p>
            <hr>
            <h3>Sınaq Balı: ${examScore}</h3>
            <h3>Ümumi Yekun Bal: ${total}</h3>
        </div>`;
}

start();
</script>

</body>
</html>














